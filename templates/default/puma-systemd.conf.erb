[Unit]
Description=Puma Rails Server
After=network.target

[Service]
Type=simple
User=deploy
WorkingDirectory=/srv/<%= @app_name %>/current
Environment=RAILS_ENV=production
Environment=RBENV_ROOT=/usr/local/rbenv
EnvironmentFile=/srv/<%= @app_name %>/shared/.env
ExecStart=/usr/local/rbenv/bin/rbenv exec bundle exec puma -S /srv/<%= @app_name %>/shared/tmp/pids/puma.state -C /srv/<%= @app_name %>/current/config/puma.rb -b unix:///srv/<%= @app_name %>/shared/tmp/sockets/puma.sock
ExecStop=/usr/local/rbenv/bin/rbenv exec bundle exec pumactl -S /srv/<%= @app_name %>/shared/tmp/pids/server.state stop
ExecReload=/usr/local/rbenv/bin/rbenv exec bundle exec pumactl  -S /srv/<%= @app_name %>/shared/tmp/pids/puma.state restart
TimeoutSec=15
Restart=always

[Install]
WantedBy=multi-user.target
